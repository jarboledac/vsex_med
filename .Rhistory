legend.title = element_blank(),
legend.position="bottom")
ggplot(data=conteo, aes(x=mes, y=n, group=year, color=year))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
scale_color_manual(fill =pal)
pal <- c('#191B4F','#1CA4C9','#511C71','#515151','#F9A61F','#178D4B','#AE3E92','#F77F11')
ggplot(data=conteo, aes(x=mes, y=n, group=year, color=year))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
scale_color_manual(fill =pal)
ggplot(data=conteo, aes(x=mes, y=n, group=year, color=year))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
scale_color_manual(values = pal)+
theme(axis.title.y=element_blank(),
axis.title.x=element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold"),
legend.title = element_blank(),
legend.position="bottom")+
geom_point(size=2)
ggplot(data=conteo, aes(x=mes, y=n, group=as.integer(year), color=year))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
scale_color_manual(values = pal)+
theme(axis.title.y=element_blank(),
axis.title.x=element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold"),
legend.title = element_blank(),
legend.position="bottom")+
geom_point(size=2)
ggplot(data=conteo, aes(x=mes, y=n, group=as.integer(year), color=year))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
theme(axis.title.y=element_blank(),
axis.title.x=element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold"),
legend.title = element_blank(),
legend.position="bottom")+
geom_point(size=2)
ggplot(data=conteo, aes(x=mes, y=n, group=as.integer(year), color=as.integer(year)))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
theme(axis.title.y=element_blank(),
axis.title.x=element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold"),
legend.title = element_blank(),
legend.position="bottom")+
geom_point(size=2)
conteo$year
conteo$n
conteo$mes
ggplot(data=conteo, aes(x=as.integer(mes), y=n, group=as.integer(year), color=as.integer(year)))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
theme(axis.title.y=element_blank(),
axis.title.x=element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold"),
legend.title = element_blank(),
legend.position="bottom")+
geom_point(size=2)
data2$mes[data2$mes == 1] <- "Ene"
data2$mes[data2$mes == 2] <- "Feb"
data2$mes[data2$mes == 3] <- "Mar"
data2$mes[data2$mes == 4] <- "Abr"
data2$mes[data2$mes == 5] <- "May"
data2$mes[data2$mes == 6] <- "Jun"
data2$mes[data2$mes == 7] <- "Jul"
data2$mes[data2$mes == 8] <- "Ago"
data2$mes[data2$mes == 9] <- "Sep"
data2$mes[data2$mes == 10] <- "Oct"
data2$mes[data2$mes == 11] <- "Nov"
data2$mes[data2$mes == 12] <- "Dic"
data2
conteo <- data2 %>%
group_by(year, mes) %>%
count()
conteo
ggplot(data=conteo, aes(x=as.integer(mes), y=n, group=as.integer(year), color=as.integer(year)))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
theme(axis.title.y=element_blank(),
axis.title.x=element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold"),
legend.title = element_blank(),
legend.position="bottom")+
geom_point(size=2)
conteo
ggplot(data=conteo, aes(x=mes, y=n, group=as.integer(year), color=as.integer(year)))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
theme(axis.title.y=element_blank(),
axis.title.x=element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold"),
legend.title = element_blank(),
legend.position="bottom")+
geom_point(size=2)
ord <- c("Ene","Feb","Mar","Abr", "May", "Jun", "Jul", "Ago", "Sep", "Oct", "Nov", "Dic")
conteo$mes<-factor(conteo$mes,levels=ord)
ggplot(data=conteo, aes(x=mes, y=n, group=as.integer(year), color=as.integer(year)))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
theme(axis.title.y=element_blank(),
axis.title.x=element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold"),
legend.title = element_blank(),
legend.position="bottom")+
geom_point(size=2)
ggplot(data=conteo, aes(x=mes, y=n, group=as.integer(year), color=as.integer(year)))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes")
ggplot(data=conteo, aes(x=mes, y=n, group=as.integer(year), color=as.integer(year)))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2)
ggplot(data=conteo, aes(x=mes, y=n, group=year, color=year))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2)
data$year <- as.integrer(year(data$fecha_ultimo_hecho))
data$year <- as.integre(year(data$fecha_ultimo_hecho))
data$year <- as.integer(year(data$fecha_ultimo_hecho))
data$mes <- month(data$fecha_ultimo_hecho)
data2 <- data[data$year >= 2018,]
data2$mes[data2$mes == 1] <- "Ene"
data2$mes[data2$mes == 2] <- "Feb"
data2$mes[data2$mes == 3] <- "Mar"
data2$mes[data2$mes == 4] <- "Abr"
data2$mes[data2$mes == 5] <- "May"
data2$mes[data2$mes == 6] <- "Jun"
data2$mes[data2$mes == 7] <- "Jul"
data2$mes[data2$mes == 8] <- "Ago"
data2$mes[data2$mes == 9] <- "Sep"
data2$mes[data2$mes == 10] <- "Oct"
data2$mes[data2$mes == 11] <- "Nov"
data2$mes[data2$mes == 12] <- "Dic"
conteo <- data2 %>%
group_by(year, mes) %>%
count()
ord <- c("Ene","Feb","Mar","Abr", "May", "Jun", "Jul", "Ago", "Sep", "Oct", "Nov", "Dic")
conteo$mes<-factor(conteo$mes,levels=ord)
pal <- c('#191B4F','#1CA4C9','#511C71','#515151','#F9A61F','#178D4B','#AE3E92','#F77F11')
ggplot(data=conteo, aes(x=mes, y=n, group=year, color=year))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2)
ggplot(data=conteo, aes(x=mes, y=n,  color=year))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2)
group=year,
ggplot(data=conteo, aes(x=mes, y=n, group=year, color=year))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2)
ggplot(data=conteo, aes(x=mes, y=n, group=year))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2)
ggplot(data=conteo, aes(x=mes, y=n, group=year, fill = year))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2)
ggplot(data=conteo, aes(x=mes, y=n, group=year, color = year))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2)
ggplot(data=conteo, aes(x=mes, y=n))+
geom_line(size=0.8, show.legend = F, group=year, color = year)+
labs(title="Vsex por mes") +
geom_point(size=2)
ggplot(data=conteo, aes(x=mes, y=n))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2)
ggplot(data=conteo, aes(x=mes, y=n, group = year))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2)
ggplot(data=conteo, aes(x=mes, y=n, group = year))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2, color = year)
ggplot(data=conteo, aes(x=mes, y=n, group = year))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2,aes(color=year))
group=year, color = year
ggplot(data=conteo, aes(x=mes, y=n, group=year, color = year))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2)
as.character(year)
ggplot(data=conteo, aes(x=mes, y=n, group=as.character(year), color = as.character(year)))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2)
ggplot(data=conteo, aes(x=mes, y=n, group=as.character(year), color = as.character(year)))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2)+
scale_fill_manual(values = pal)
ggplot(data=conteo, aes(x=mes, y=n, group=as.character(year), color = as.character(year)))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2)+
scale_color_manual(values = pal)
ggplot(data=conteo, aes(x=mes, y=n, group=as.character(year), color = as.character(year)))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2)+
scale_color_manual(values = pal)+
labs(fill = Años)
ggplot(data=conteo, aes(x=mes, y=n, group=as.character(year), color = as.character(year)))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2)+
scale_color_manual(values = pal)+
labs(fill = year)
ggplot(data=conteo, aes(x=mes, y=n, group=as.character(year), color = as.character(year)))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2)+
scale_color_manual(values = pal)+ labs(fill = "Año")
ggplot(data=conteo, aes(x=mes, y=n, group=as.character(year), color = as.character(year)))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2)+
scale_color_manual(values = pal)+ labs(colour = "Año")
coord_hom <- separate_lon_lat(data, "punto_hecho")
homi_sf <- st_as_sf(coord_hom,coords = c('longitud', 'latitud') ,crs = 4326)
#Gráfico
ggplot()+
annotation_map_tile()+
geom_sf(data = homi_sf)
shp_name <- file.choose()
medellin_lsoa <- st_read(shp_name) # Se leyeron las formas de las comunas.
View(medellin_lsoa)
ggplot()+
geom_sf(data = medellin_lsoa)
new_object <- select(data, codigo_comuna_hecho )
new_object <- na.omit(new_object)
count_crimes <- new_object %>%
group_by(codigo_comuna_hecho) %>%
summarise(count = n())
med_lsoa <- left_join(medellin_lsoa, count_crimes, by = c("COMUNA"="codigo_comuna_hecho"))
ggplot()+
annotation_map_tile()+
geom_sf(data = med_lsoa, aes(fill = count), alpha = 0.9)+
scale_fill_gradient2(name ="Número de homicidios")
medellin_lsoa
ggplot()+
geom_sf(data = medellin_lsoa)
new_object
new_object
new_object
new_object <- select(data2, codigo_comuna_hecho )
new_object
new_object <- na.omit(new_object)
new_object
count_crimes <- new_object %>%
group_by(codigo_comuna_hecho) %>%
summarise(count = n())
count_crimes
med_lsoa <- left_join(medellin_lsoa, count_crimes, by = c("COMUNA"="codigo_comuna_hecho"))
medellin_lsoa
med_lsoa <- left_join(medellin_lsoa, count_crimes, by = c("COMUNA"="codigo_comuna_hecho"))
count_crimes
medellin_lsoa
medellin_lsoa$COMUNA
count_crimes$codigo_comuna_hecho
count_crimes$codigo_comuna_hecho <- as.character(count_crimes$codigo_comuna_hecho)
med_lsoa <- left_join(medellin_lsoa, count_crimes, by = c("COMUNA"="codigo_comuna_hecho"))
ggplot()+
annotation_map_tile()+
geom_sf(data = med_lsoa, aes(fill = count), alpha = 0.9)+
scale_fill_gradient2(name ="Número de homicidios")
med_lsoa
medellin_lsoa <- st_read(shp_name) # Se leyeron las formas de las comunas.
medellin_lsoa
new_object <- select(data2, codigo_comuna_hecho )
new_object <- na.omit(new_object)
count_crimes <- new_object %>%
group_by(codigo_comuna_hecho) %>%
summarise(count = n())
count_crimes$codigo_comuna_hecho <- as.character(count_crimes$codigo_comuna_hecho)
medellin_lsoa
med_lsoa <- left_join(medellin_lsoa, count_crimes, by = c("COMUNA"="codigo_comuna_hecho"))
med_lsoa
colnames(med_lsoa)
count_crimes
med_lsoa <- left_join(medellin_lsoa, count_crimes, by = c("COMUNA"="codigo_comuna_hecho"))
med_lsoa
ggplot()+
annotation_map_tile()+
geom_sf(data = med_lsoa, aes(fill = count.x), alpha = 0.9)+
scale_fill_gradient2(name ="Número de homicidios")
new_object
new_object
count_crimes
med_lsoa <- left_join(medellin_lsoa, count_crimes, by = c("COMUNA"="codigo_comuna_hecho"))
med_lsoa
medellin_lsoa$COMUNA
count_crimes$codigo_comuna_hecho
new_object <- select(data2, codigo_comuna_hecho )
new_object <- na.omit(new_object)
count_crimes <- new_object %>%
group_by(codigo_comuna_hecho) %>%
summarise(count = n())
count_crimes$codigo_comuna_hecho
medellin_lsoa$COMUNA <- as.integer(medellin_lsoa$COMUNA)
med_lsoa <- left_join(medellin_lsoa, count_crimes, by = c("COMUNA"="codigo_comuna_hecho"))
med_lsoa
medellin_lsoa$COMUNA
med_lsoa <- left_join(medellin_lsoa, count_crimes, by = c("COMUNA"="codigo_comuna_hecho"))
ggplot()+
annotation_map_tile()+
geom_sf(data = med_lsoa, aes(fill = count.x), alpha = 0.9)+
scale_fill_gradient2(name ="Número de homicidios")
new_object <- select(data2, codigo_comuna_hecho )
new_object
new_object
new_object
new_object <- na.omit(new_object)
new_object
count_crimes
count_crimes <- new_object %>%
group_by(codigo_comuna_hecho) %>%
summarise(count = n())
count_crimes
medellin_lsoa
med_lsoa <- left_join(medellin_lsoa, count_crimes, by = c("COMUNA"="codigo_comuna_hecho"))
med_lsoa
count_crimes
med_lsoa <- left_join(medellin_lsoa, count_crimes, by = c("COMUNA"="codigo_comuna_hecho"))
med_lsoa
coord_hom <- separate_lon_lat(data2, "punto_hecho")
homi_sf <- st_as_sf(coord_hom,coords = c('longitud', 'latitud') ,crs = 4326)
#Gráfico
ggplot()+
annotation_map_tile()+
geom_sf(data = homi_sf)
medellin_lsoa <- st_read(shp_name) # Se leyeron las formas de las comunas.
ggplot()+
geom_sf(data = medellin_lsoa)
new_object <- select(data2, codigo_comuna_hecho )
new_object
new_object <- na.omit(new_object)
new_object
count_crimes <- new_object %>%
group_by(codigo_comuna_hecho) %>%
summarise(count = n())
count_crimes
med_lsoa <- left_join(medellin_lsoa, count_crimes, by = c("COMUNA"="codigo_comuna_hecho"))
medellin_lsoa
medellin_lsoa$COMUNA <- as.integer(medellin_lsoa$COMUNA)
medellin_lsoa
count_crimes
count_crimes$codigo_comuna_hecho <- as.integer(count_crimes$codigo_comuna_hecho)
count_crimes
medellin_lsoa
med_lsoa <- left_join(medellin_lsoa, count_crimes, by = c("COMUNA"="codigo_comuna_hecho"))
med_lsoa
ggplot()+
annotation_map_tile()+
geom_sf(data = med_lsoa, aes(fill = count.x), alpha = 0.9)+
scale_fill_gradient2(name ="Número de homicidios")
ggplot()+
annotation_map_tile()+
geom_sf(data = med_lsoa, aes(fill = count.y), alpha = 0.9)+
scale_fill_gradient2(name ="Número de homicidios")
medellin_lsoa
count_crimes
med_lsoa <- left_join(medellin_lsoa, count_crimes, by = c("COMUNA"="codigo_comuna_hecho"))
med_lsoa
medellin_lsoa
colnames(medellin_lsoa)
count_crimes
count_crimes <- new_object %>%
group_by(codigo_comuna_hecho) %>%
summarise(total = n())
medellin_lsoa$COMUNA <- as.integer(medellin_lsoa$COMUNA)
count_crimes$codigo_comuna_hecho <- as.integer(count_crimes$codigo_comuna_hecho)
med_lsoa <- left_join(medellin_lsoa, count_crimes, by = c("COMUNA"="codigo_comuna_hecho"))
med_lsoa
coord_hom <- separate_lon_lat(data2, "punto_hecho")
coord_hom
homi_sf <- st_as_sf(coord_hom,coords = c('longitud', 'latitud') ,crs = 4326)
homi_sf
medellin_lsoa <- st_read(shp_name) # Se leyeron las formas de las comunas.
medellin_lsoa
shp_name <- file.choose()
medellin_lsoa <- st_read(shp_name) # Se leyeron las formas de las comunas.
medellin_lsoa
medellin_lsoa
medellin_lsoa
medellin_lsoa
medellin_lsoa
new_object <- select(data2, codigo_comuna_hecho )
new_object <- na.omit(new_object)
new_object
count_crimes <- new_object %>%
group_by(codigo_comuna_hecho) %>%
summarise(total = n())
count_crimes
medellin_lsoa$COMUNA <- as.integer(medellin_lsoa$COMUNA)
count_crimes$codigo_comuna_hecho <- as.integer(count_crimes$codigo_comuna_hecho)
med_lsoa <- left_join(medellin_lsoa, count_crimes, by = c("COMUNA"="codigo_comuna_hecho"))
med_lsoa
ggplot()+
annotation_map_tile()+
geom_sf(data = med_lsoa, aes(fill = total), alpha = 0.9)+
scale_fill_gradient2(name ="Número de homicidios")
ggplot(data=conteo, aes(x=mes, y=n, group=as.character(year), color = as.character(year)))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2)+
scale_color_manual(values = pal)+ labs(colour = "Año")
ggplot(data=conteo, aes(x=mes, y=n, group=as.character(year), color = as.character(year)))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2)+
scale_color_manual(values = pal)
ggplot(data=conteo, aes(x=mes, y=n, group=as.character(year), color = as.character(year)))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2)+
labs(colour = "Año")
conteo
conteo[year= 2018]
conteo[conteo$year= 2018]
conteo[conteo$year==2018]
conteo[conteo$year==2018,]
max(conteo[conteo$year==2018,])
which.max(conteo[conteo$year==2018,])
max(conteo[conteo$year==2018,]$n)
conteo[conteo$year==2018,]
colnames(data2)
data2 %>%
group_by(year, delito) %>% summarise(total = n())
library(dplyr)
library(readxl)
library(janitor)
library(sf)
library(tidyverse)
library(ggplot2)
library(ggspatial)
library(dplyr)
library(lubridate)
source("/Users/jeferson/Documents/sisc/gestion_conocimiento/crime_mapping/functions.R")
source("/Users/jeferson/Documents/sisc/gestion_conocimiento/Sondeo_VIF/funciones.R")
data <- read_excel("/Users/jeferson/Documents/sisc/gestion_conocimiento/vsex_med/Archivo_plano_victima_202201290910_filter.xlsx")
data$year <- as.integer(year(data$fecha_ultimo_hecho))
data$mes <- month(data$fecha_ultimo_hecho)
data2 <- data[data$year >= 2018,]
data2$mes[data2$mes == 1] <- "Ene"
data2$mes[data2$mes == 2] <- "Feb"
data2$mes[data2$mes == 3] <- "Mar"
data2$mes[data2$mes == 4] <- "Abr"
data2$mes[data2$mes == 5] <- "May"
data2$mes[data2$mes == 6] <- "Jun"
data2$mes[data2$mes == 7] <- "Jul"
data2$mes[data2$mes == 8] <- "Ago"
data2$mes[data2$mes == 9] <- "Sep"
data2$mes[data2$mes == 10] <- "Oct"
data2$mes[data2$mes == 11] <- "Nov"
data2$mes[data2$mes == 12] <- "Dic"
conteo <- data2 %>%
group_by(year, mes) %>%
count()
ord <- c("Ene","Feb","Mar","Abr", "May", "Jun", "Jul", "Ago", "Sep", "Oct", "Nov", "Dic")
conteo$mes<-factor(conteo$mes,levels=ord)
pal <- c('#191B4F','#1CA4C9','#511C71','#515151','#F9A61F','#178D4B','#AE3E92','#F77F11')
ggplot(data=conteo, aes(x=mes, y=n, group=as.character(year), color = as.character(year)))+
geom_line(size=0.8, show.legend = F)+
labs(title="Vsex por mes") +
geom_point(size=2)+
labs(colour = "Año")
##georef
coord_hom <- separate_lon_lat(data2, "punto_hecho")
homi_sf <- st_as_sf(coord_hom,coords = c('longitud', 'latitud') ,crs = 4326)
#Gráfico
ggplot()+
annotation_map_tile()+
geom_sf(data = homi_sf)
shp_name <- file.choose()
medellin_lsoa <- st_read(shp_name) # Se leyeron las formas de las comunas.
View(medellin_lsoa)
#Gráfico de shapes
ggplot()+
geom_sf(data = medellin_lsoa)
new_object <- select(data2, codigo_comuna_hecho )
new_object <- na.omit(new_object)
count_crimes <- new_object %>%
group_by(codigo_comuna_hecho) %>%
summarise(total = n())
medellin_lsoa$COMUNA <- as.integer(medellin_lsoa$COMUNA)
count_crimes$codigo_comuna_hecho <- as.integer(count_crimes$codigo_comuna_hecho)
med_lsoa <- left_join(medellin_lsoa, count_crimes, by = c("COMUNA"="codigo_comuna_hecho"))
ggplot()+
annotation_map_tile()+
geom_sf(data = med_lsoa, aes(fill = total), alpha = 0.9)+
scale_fill_gradient2(name ="Número de homicidios")
colnames(data2)
